import{j as e,L as D}from"./index-IiThSvd3.js";import{R as i}from"./react-vendor-DTkXckhQ.js";import{t as J,s as j,U as _,V,W as E,Y as W,c as Y,Z as K}from"./icons-J8W3zK9a.js";const N=800,A="chat:nick",C=["Скай-Страж","Право-Самурай","Пульс-Рейдер","Кибер-Медик","Неон-Тактик","Астрал-Офицер","Фантом-Лечащий","Шифр-Инспектор","Квант-Боец","Пиксель-Волк","Туман-Командор","Искра-Наблюдатель","Нуль-Гравитация","Полярный Пилот","Городской Хирург","Сыворотка-Vibe","Стерильный Ниндзя","Скальпель-Облако","Рентген-Панк","Ватка-Supreme"];function I(){const t=C[Math.floor(Math.random()*C.length)],p=Math.floor(Math.random()*900+100);return`${t} #${p}`}function T({room:t="global",className:p}){const u="wss://notifications-worker.wizardiowhy.workers.dev/chat",[m,w]=i.useState(!1),[h,v]=i.useState(!1),[y,k]=i.useState(""),[g,b]=i.useState([]),a=i.useRef(null),S=i.useRef(null),[f]=i.useState(()=>{try{const s=localStorage.getItem(A);if(s)return s;const l=I();return localStorage.setItem(A,l),l}catch{return I()}});i.useEffect(()=>{const s=S.current;s&&(s.scrollTop=s.scrollHeight)},[g.length]),i.useEffect(()=>{let s=!1,l=0;const x=()=>{if(s)return;const d=new URL(u);d.searchParams.set("room",t);const n=new WebSocket(d);a.current=n,n.addEventListener("open",()=>{w(!0),l=0,n.send(JSON.stringify({type:"hello",name:f}))}),n.addEventListener("message",P=>{try{const r=JSON.parse(P.data);r.type==="history"?b(r.messages):r.type==="message"?b(c=>c.some(o=>o.id===r.message.id)?c:[...c,r.message]):r.type==="delete"?b(c=>c.filter(o=>o.id!==r.id)):r.type==="edit"?b(c=>c.map(o=>o.id===r.id?{...o,text:r.text}:o)):r.type==="system"&&(r.text==="admin-ok"&&v(!0),r.text==="hello-ok"&&v(!1))}catch{}});const M=()=>{w(!1),!s&&(l=Math.min(l+1,6),setTimeout(x,400*l))};n.addEventListener("close",M),n.addEventListener("error",()=>n.close())};return x(),()=>{var d;s=!0;try{(d=a.current)==null||d.close()}catch{}}},[u,t,f]);function O(){const s=y.replace(/\s+/g," ").trim();!s||!a.current||a.current.readyState!==WebSocket.OPEN||(a.current.send(JSON.stringify({type:"message",text:s.slice(0,N)})),k(""))}function R(s){!h||!a.current||a.current.readyState!==WebSocket.OPEN||a.current.send(JSON.stringify({type:"delete",id:s}))}function L(s,l){var d;if(!h||!a.current||a.current.readyState!==WebSocket.OPEN)return;const x=(d=prompt("Изменить сообщение:",l))==null?void 0:d.trim();x&&a.current.send(JSON.stringify({type:"edit",id:s,text:x.slice(0,N)}))}return e.jsxs("div",{className:`rounded-2xl border border-[color:var(--card-border,rgba(255,255,255,0.12))] bg-[color:var(--surface,rgba(255,255,255,0.06))] p-3 text-sm backdrop-blur ${p??""}`,children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Общий чат"}),e.jsx("span",{className:`ml-2 inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[11px] ${m?"bg-emerald-500/15 text-emerald-200 border border-emerald-400/30":"bg-rose-500/15 text-rose-200 border border-rose-400/30"}`,children:m?"online":"offline"}),h&&e.jsx("span",{className:"ml-2 rounded-full border border-sky-400/40 bg-sky-500/20 px-2 py-0.5 text-[11px] text-sky-100",children:"Admin"})]}),e.jsxs("div",{className:"text-xs opacity-75",children:["Ваш ник: ",e.jsx("b",{children:f})]})]}),!u,e.jsxs("div",{ref:S,className:"max-h-80 overflow-auto rounded-lg border border-[color:var(--card-border,rgba(255,255,255,0.12))] bg-white/5 p-2 dark:bg-black/20",children:[g.length===0&&e.jsx("div",{className:"opacity-70",children:"Пока сообщений нет. Напишите первым!"}),e.jsx("ul",{className:"space-y-1",children:g.map(s=>e.jsxs("li",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs opacity-70",children:[new Date(s.ts).toLocaleString()," · ",e.jsx("b",{children:s.author})]}),e.jsx("div",{children:s.text})]}),h&&e.jsxs("div",{className:"shrink-0 space-x-1",children:[e.jsx("button",{className:"btn !px-2 !py-0.5",onClick:()=>L(s.id,s.text),children:"Ред."}),e.jsx("button",{className:"btn !px-2 !py-0.5",onClick:()=>R(s.id),children:"Удал."})]})]},s.id))})]}),e.jsxs("form",{className:"mt-2 flex items-center gap-2",onSubmit:s=>{s.preventDefault(),O()},children:[e.jsx("input",{className:"flex-1 rounded-md border border-[color:var(--card-border,rgba(255,255,255,0.12))] bg-transparent px-2 py-1",placeholder:"Напишите сообщение…",value:y,onChange:s=>k(s.target.value),maxLength:N,disabled:!m}),e.jsx("button",{type:"submit",className:"btn btn-primary disabled:opacity-50",disabled:!m,children:"Отправить"})]})]})}function H(){return e.jsxs("main",{className:"relative min-h-dvh w-full overflow-x-hidden text-white",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-slate-950 to-slate-900"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(900px_600px_at_15%_10%,rgba(56,189,248,0.25),transparent_70%),radial-gradient(800px_500px_at_85%_20%,rgba(129,140,248,0.25),transparent_70%),radial-gradient(700px_600px_at_50%_100%,rgba(244,63,94,0.14),transparent_70%)]"})]}),e.jsx("header",{className:"sticky top-0 z-20 mx-auto w-full max-w-6xl px-4 pt-6 sm:px-6 lg:px-8",children:e.jsx("div",{className:"rounded-2xl border border-[color:var(--card-border,rgba(255,255,255,0.12))] bg-[color:var(--surface,rgba(255,255,255,0.08))] px-4 py-3 backdrop-blur-md",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-xl bg-gradient-to-br from-sky-500/80 to-indigo-500/80 shadow-lg shadow-sky-500/20",children:e.jsx(J,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm uppercase tracking-[0.22em] text-white/70",children:"SKY • PRAVO"}),e.jsx("div",{className:"-mt-0.5 text-lg font-semibold",children:"Центр управления"})]})]}),e.jsxs("nav",{className:"hidden items-center gap-2 sm:flex",children:[e.jsx("a",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-white/80 hover:bg-white/10",href:"#news",children:"Новости"}),e.jsx("a",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-white/80 hover:bg-white/10",href:"#chat",children:"Чат"}),e.jsx("a",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-white/80 hover:bg-white/10",href:"#links",children:"Ссылки"})]})]})})}),e.jsx("section",{className:"mx-auto mt-8 w-full max-w-6xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-white/10 bg-white/10 p-8 shadow-[0_40px_120px_-60px_rgba(56,189,248,0.45)] backdrop-blur",children:[e.jsx("div",{className:"absolute -right-16 -top-16 h-56 w-56 rounded-full bg-gradient-to-br from-sky-500 to-indigo-500 opacity-40 blur-3xl","aria-hidden":!0}),e.jsx("div",{className:"absolute -bottom-20 -left-10 h-64 w-64 rounded-full bg-gradient-to-br from-fuchsia-500 to-rose-500 opacity-30 blur-3xl","aria-hidden":!0}),e.jsx(D,{}),e.jsxs("div",{className:"relative grid gap-8 lg:grid-cols-2 lg:items-center",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("h1",{className:"text-4xl font-bold leading-tight sm:text-5xl sm:leading-[1.1]",children:["Главная панель ",e.jsx("span",{className:"text-sky-300",children:"сообщества"})]}),e.jsx("p",{className:"max-w-2xl text-white/80 sm:text-lg",children:"Новости, цели и чат команды — в одном месте. Неоновый ночной стиль + жидкое стекло под твой сайт."}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("a",{href:"#chat",className:"group inline-flex items-center gap-2 rounded-2xl border border-sky-400/40 bg-sky-500/20 px-4 py-2 text-sky-100 hover:bg-sky-500/30",children:["Открыть чат",e.jsx(j,{className:"h-4 w-4 transition-transform group-hover:translate-x-0.5"})]}),e.jsx("a",{href:"#links",className:"inline-flex items-center gap-2 rounded-2xl border border-white/10 bg-white/5 px-4 py-2 text-white/80 hover:bg-white/10",children:"Полезные ссылки"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-white/70",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1.5",children:[e.jsx(_,{className:"h-4 w-4"})," Команда"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1.5",children:[e.jsx(V,{className:"h-4 w-4"})," Поддержка"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1.5",children:[e.jsx(E,{className:"h-4 w-4"})," События"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{label:"Участники",value:"142",Icon:_},{label:"Повышений за нед.",value:"18",Icon:W},{label:"Активные задачи",value:"7",Icon:Y},{label:"События на неделе",value:"5",Icon:E}].map(t=>e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-slate-950/60 p-5 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center justify-between text-white/70",children:[e.jsx("span",{className:"text-sm",children:t.label}),e.jsx(t.Icon,{className:"h-4 w-4"})]}),e.jsx("div",{className:"mt-2 text-2xl font-semibold",children:t.value})]},t.label))})]})]})}),e.jsx("section",{id:"news",className:"mx-auto mt-10 w-full max-w-6xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-5",children:[e.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/10 p-6 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Новости"}),e.jsx(K,{className:"h-5 w-5 text-white/60"})]}),e.jsxs("ul",{className:"mt-4 space-y-3 text-sm text-white/85",children:[e.jsxs("li",{className:"rounded-2xl border border-emerald-400/30 bg-emerald-500/10 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-white/70",children:["Сегодня • 18:00 ",e.jsx("span",{className:"rounded-full border border-emerald-400/50 bg-emerald-400/20 px-2 py-0.5 text-emerald-100",children:"Обновление"})]}),e.jsx("p",{className:"mt-1",children:"Обновлён регламент по повышению медперсонала. Проверь раздел «Документы»."})]}),e.jsxs("li",{className:"rounded-2xl border border-sky-400/30 bg-sky-500/10 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-white/70",children:["Вчера • 22:15 ",e.jsx("span",{className:"rounded-full border border-sky-400/50 bg-sky-400/20 px-2 py-0.5 text-sky-100",children:"Событие"})]}),e.jsx("p",{className:"mt-1",children:"Совместный рейд завершён успешно. Отдельное спасибо кураторам."})]}),e.jsxs("li",{className:"rounded-2xl border border-amber-400/30 bg-amber-500/10 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-white/70",children:["На этой неделе ",e.jsx("span",{className:"rounded-full border border-amber-400/50 bg-amber-400/20 px-2 py-0.5 text-amber-100",children:"Важно"})]}),e.jsx("p",{className:"mt-1",children:"Собрать отчёты по отделам до пятницы 20:00."})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-6 backdrop-blur",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Ближайшие дела"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-white/80",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-400"})," Проверить заявки на повышение (до 12:00 завтра)"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-sky-400"})," Подготовить план мероприятия на выходные"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-rose-400"})," Отправить сводку по отделам"]})]})]})]}),e.jsxs("div",{id:"chat",className:"lg:col-span-3",children:[e.jsxs("div",{className:"flex items-center justify-between pb-3",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Командный чат"}),e.jsx("span",{className:"text-sm text-white/60",children:"Онлайн: ~"})]}),e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-white/10 bg-slate-950/60 p-4 shadow-2xl backdrop-blur",children:[e.jsx(T,{room:"global",allowAdminEdit:!0,className:"bg-transparent border-0 p-0"}),e.jsxs("p",{className:"mt-2 text-xs text-white/60",children:["Чтобы писать как ",e.jsx("b",{children:"Admin"}),", владелец вводит секретный ключ ",e.jsx("code",{children:"VITE_CHAT_ADMIN_CODE"})," через кнопку «🔑 Admin»."]})]})]})]})}),e.jsxs("section",{id:"links",className:"mx-auto mt-10 w-full max-w-6xl px-4 pb-16 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/10 p-6 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Быстрые ссылки"}),e.jsx(j,{className:"h-5 w-5 text-white/60"})]}),e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[{title:"Документы",desc:"Регламенты, уставы, шаблоны",href:"/pravo/docs"},{title:"Повышения",desc:"Критерии и заявки",href:"/pravo/promotions"},{title:"Состав",desc:"Роли, отделы, контакты",href:"/pravo/teams"},{title:"Отчёты",desc:"Еженедельные сводки",href:"/pravo/reports"}].map(t=>e.jsx("a",{href:t.href,className:"group rounded-2xl border border-white/10 bg-slate-950/60 p-4 backdrop-blur transition hover:border-white/20 hover:bg-slate-900/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium",children:t.title}),e.jsx("div",{className:"text-xs text-white/70",children:t.desc})]}),e.jsx(j,{className:"h-4 w-4 translate-x-0 transition-transform group-hover:translate-x-1"})]})},t.title))})]}),e.jsxs("footer",{className:"mt-8 flex items-center justify-between text-xs text-white/60",children:[e.jsxs("div",{children:["© ",new Date().getFullYear()," SKY • PRAVO"]}),e.jsx("a",{href:"#top",className:"rounded-lg border border-white/10 bg-white/5 px-2 py-1 hover:bg-white/10",children:"Наверх"})]})]})]})}export{H as default};
