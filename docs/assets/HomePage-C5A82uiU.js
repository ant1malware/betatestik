import{j as e}from"./index-BXdVlu4A.js";import{R as n,L as re}from"./react-vendor-DTkXckhQ.js";import{t as B,s as ne,V as ce,W as V,Y as q,M as G,c as ie,Z as le,_ as oe,$ as de,a0 as xe,a1 as pe,U as me}from"./icons-Do8hWDzb.js";const W=800,F=["Скай-Страж","Право-Самурай","Пульс-Рейдер","Кибер-Медик","Неон-Тактик","Астрал-Офицер","Фантом-Лечащий","Шифр-Инспектор","Квант-Боец","Пиксель-Волк","Туман-Командор","Искра-Наблюдатель","Нуль-Гравитация","Полярный Пилот","Городской Хирург","Сыворотка-Vibe","Стерильный Ниндзя","Скальпель-Облако","Рентген-Панк","Ватка-Supreme"];function k(){const i=F[Math.floor(Math.random()*F.length)],s=Math.floor(Math.random()*900+100);return`${i} ${s}`}function he(i){try{return typeof i=="string"?JSON.parse(i):i instanceof ArrayBuffer?JSON.parse(new TextDecoder().decode(i)):(typeof Blob<"u"&&i instanceof Blob,null)}catch{return null}}function ue(i){return new Date(i).toLocaleTimeString(void 0,{hour12:!1})}const fe=`
.rc-wrap{border:1px solid #111;background:rgba(15,16,18,.92);border-radius:12px;overflow:hidden;font:13px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Helvetica Neue',Arial, sans-serif;box-shadow:0 20px 40px rgba(0,0,0,.35)}
.rc-head{padding:12px 14px;color:#d1d5db;background:rgba(12,13,16,.92);border-bottom:1px solid rgba(148,163,184,.12);display:flex;justify-content:space-between;align-items:center;gap:16px}
.rc-head-title{font-weight:600;font-size:14px;letter-spacing:.02em;text-transform:uppercase;color:#e2e8f0}
.rc-head-meta{display:flex;align-items:center;gap:12px}
.rc-presence{display:flex;align-items:center;gap:8px;font-size:12px;color:#94a3b8;letter-spacing:.01em}
.rc-presence-dot{width:10px;height:10px;border-radius:999px;background:#ef4444;box-shadow:0 0 12px rgba(239,68,68,.4);transition:all .25s ease}
.rc-presence-dot.on{background:#22c55e;box-shadow:0 0 12px rgba(34,197,94,.45)}
.rc-presence-count{display:flex;align-items:baseline;gap:4px;font-weight:600;color:#f8fafc}
.rc-presence-count span{font-size:11px;font-weight:500;color:#94a3b8;text-transform:uppercase;letter-spacing:.08em}
.rc-role-pill{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;background:rgba(56,189,248,.12);color:#bae6fd;font-size:11px;letter-spacing:.08em;border:1px solid rgba(56,189,248,.3)}
.rc-list{height:280px;overflow:auto;background:#1a1a1b}
.rc-list ul{list-style:none;margin:0;padding:0}
.rc-list li{padding:3px 8px;white-space:pre-wrap;word-break:break-word}
.rc-list li:nth-child(odd){background:#232324}
.rc-list li:nth-child(even){background:#1e1e1f}
.rc-ts{color:#9da1a6;margin-right:6px}
.rc-me{color:#a3d977;font-weight:600}
.rc-other{color:#e06c75;font-weight:600}
.rc-admin{color:#facc15;font-weight:700}
.rc-form{display:flex;gap:6px;padding:6px;background:#0f0f10;border-top:1px solid #0b0b0b}
.rc-input{flex:1;background:#0f0f10;border:1px solid #2a2a2b;color:#e5e7eb;border-radius:4px;padding:6px 8px}
.rc-btn{background:#2b2b2c;border:1px solid #3a3a3c;color:#e5e7eb;border-radius:4px;padding:6px 10px;cursor:pointer}
.rc-btn:disabled{opacity:.6;cursor:not-allowed}
.rc-actions{display:flex;gap:4px;margin-left:8px}
.rc-ax{font-size:12px;background:#2b2b2c;border:1px solid #3a3a3c;color:#ccc;border-radius:4px;padding:2px 6px;cursor:pointer}
.rc-empty{opacity:.7;padding:6px 8px}
.nick-back{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:1000}
.nick-card{width:min(92vw,520px);background:#121316;border:1px solid #2a2a2b;border-radius:10px;padding:14px;color:#e5e7eb}
.nick-row{display:flex;gap:8px;margin-top:10px}
.nick-input{flex:1;background:#0f0f10;border:1px solid #2a2a2b;color:#e5e7eb;border-radius:6px;padding:8px}
.nick-btn{background:#243040;border:1px solid #375a7a;color:#d6e8ff;border-radius:6px;padding:8px 12px;cursor:pointer}
.nick-pill{display:inline-block;margin-top:8px;margin-right:6px;background:#222427;border:1px solid #303236;border-radius:999px;padding:4px 10px;cursor:pointer}
.nick-warn{font-size:12px;color:#b3b7bf;opacity:.9;margin-top:6px}
`;function be(i){try{const s=new URL(i);return s.protocol=s.protocol==="wss:"?"https:":s.protocol==="ws:"?"http:":s.protocol,s.pathname="/",s.search="",s.hash="",s.toString().replace(/\/+$/,"")}catch{return""}}function ge(i){const s=`@e${i}`;return{NAME_KEY:`chat:nick${s}`,NAME_LOCK:`chat:nick:lock${s}`}}function Ne({room:i="global",className:s}){const N="wss://notifications-worker.wizardiowhy.workers.dev/chat",C=n.useMemo(()=>be(N),[N]),[$,R]=n.useState(1),[o,M]=n.useState(!1),h=n.useMemo(()=>ge($),[$]),[E,A]=n.useState(!1),[Q,L]=n.useState(0),[y,z]=n.useState(!1),[D,H]=n.useState(""),[O,j]=n.useState([]),f=n.useRef(null),J=n.useRef(null),v=n.useRef({}),[d,w]=n.useState(null),[p,S]=n.useState(!0),[P,m]=n.useState(k()),U=n.useRef({epochReady:o,needNick:p,nick:d}),Y=n.useRef(h),b=n.useRef(null);n.useEffect(()=>{if(o)try{const t=localStorage.getItem(h.NAME_KEY),r=localStorage.getItem(h.NAME_LOCK)==="1";t&&r?(w(t),S(!1),m(t)):t&&!r?(w(t),m(t),S(!0)):(w(null),m(k()),S(!0))}catch{w(null),m(k()),S(!0)}},[o,h.NAME_KEY,h.NAME_LOCK]),n.useEffect(()=>{U.current={epochReady:o,needNick:p,nick:d}},[o,p,d]),n.useEffect(()=>{Y.current=h},[h]),n.useEffect(()=>{p&&(b.current=null)},[p]),n.useEffect(()=>{let t=!1;if(!C){R(1),M(!0);return}return(async()=>{try{const r=await fetch(`${C}/nick-epoch`,{credentials:"include"}),c=r.ok&&Number((await r.json().catch(()=>({}))).epoch)||1;t||(R(c),M(!0))}catch{t||(R(1),M(!0))}})(),()=>{t=!0}},[C]),n.useEffect(()=>{const t=J.current;t&&(t.scrollTop=t.scrollHeight)},[O.length]),n.useEffect(()=>{let t=!1,r=0,c=null;const u=()=>{if(t)return;A(!1);const g=new URL(N);g.searchParams.set("room",i),c=new WebSocket(g),f.current=c,c.addEventListener("open",()=>{A(!0),v.current={},r=0,L(0);const{epochReady:_,needNick:a,nick:l}=U.current;if(_&&l&&!a)try{c.send(JSON.stringify({type:"hello",name:l})),b.current=l}catch{}}),c.addEventListener("message",async _=>{try{let a=he(_.data);if(!a&&typeof Blob<"u"&&_.data instanceof Blob&&(a=JSON.parse(await _.data.text())),!a)return;if(a.type==="history")j(a.messages);else if(a.type==="message"){const l=a.cid;if(l&&v.current[l]){const x=v.current[l];delete v.current[l],j(K=>{const I=K.filter(T=>T.id!==x);return I.some(T=>T.id===a.message.id)?I:[...I,a.message]})}else j(x=>x.some(K=>K.id===a.message.id)?x:[...x,a.message])}else if(a.type==="delete")j(l=>l.filter(x=>x.id!==a.id));else if(a.type==="edit")j(l=>l.map(x=>x.id===a.id?{...x,text:a.text}:x));else if(a.type==="system"){if(a.text==="admin-ok"?z(!0):a.text==="hello-ok"&&!a.name&&z(!1),a.text==="presence"){const l=Number(a.count);L(Number.isFinite(l)&&l>0?Math.round(l):0)}if(a.name&&(a.text==="hello-ok"||a.text==="admin-ok")){w(a.name),m(a.name),b.current=a.name;try{const{NAME_KEY:l,NAME_LOCK:x}=Y.current;localStorage.setItem(l,a.name),localStorage.setItem(x,"1")}catch{}S(!1)}}}catch{}});const ae=()=>{t||(A(!1),L(0),r=Math.min(r+1,6),setTimeout(u,400*r))};c.addEventListener("close",ae),c.addEventListener("error",()=>c==null?void 0:c.close())};return u(),()=>{t=!0;try{c==null||c.close()}catch{}f.current=null,b.current=null}},[N,i]),n.useEffect(()=>{const t=f.current;if(!(!t||t.readyState!==WebSocket.OPEN)&&!(!o||p||!d)&&b.current!==d)try{t.send(JSON.stringify({type:"hello",name:d})),b.current=d}catch{}},[o,p,d]);function Z(){const r=((P||"").trim().slice(0,80)||k()).replace(/[^\p{L}\p{N}_ -]+/gu,"");w(r),m(r);try{localStorage.setItem(h.NAME_KEY,r)}catch{}const c=f.current;if(c&&c.readyState===WebSocket.OPEN)try{c.send(JSON.stringify({type:"hello",name:r})),b.current=r}catch{}}function X(){const t=D.replace(/\s+/g," ").trim(),r=f.current;if(!o||!d||p||!t||!r||r.readyState!==WebSocket.OPEN)return;const c=`${Date.now()}_${Math.random().toString(36).slice(2)}`,u=`loc_${c}`;v.current[c]=u,j(g=>[...g,{id:u,author:y?"Admin":d,text:t,ts:Date.now()}]),r.send(JSON.stringify({type:"message",text:t.slice(0,W),cid:c})),H("")}const ee=t=>{const r=f.current;!y||!r||r.readyState!==WebSocket.OPEN||r.send(JSON.stringify({type:"delete",id:t}))},te=(t,r)=>{var g;const c=f.current;if(!y||!c||c.readyState!==WebSocket.OPEN)return;const u=(g=prompt("Изменить сообщение:",r))==null?void 0:g.trim();u&&c.send(JSON.stringify({type:"edit",id:t,text:u.slice(0,W)}))},se=t=>t==="Admin"?"rc-admin":t===d?"rc-me":"rc-other";return e.jsxs("div",{className:s??"",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:fe}}),e.jsxs("div",{className:"rc-wrap","aria-busy":!o,children:[e.jsxs("div",{className:"rc-head",children:[e.jsx("div",{className:"rc-head-title",children:"Командный чат"}),e.jsxs("div",{className:"rc-head-meta",children:[e.jsxs("div",{className:"rc-presence",role:"status","aria-live":"polite",children:[e.jsx("span",{className:`rc-presence-dot ${E?"on":""}`,"aria-hidden":!0}),e.jsxs("span",{className:"rc-presence-count",children:[E?Math.max(Q,0):0,e.jsx("span",{children:"в сети"})]})]}),y&&e.jsx("span",{className:"rc-role-pill",children:"ADMIN"})]})]}),e.jsx("div",{ref:J,className:"rc-list",children:o?O.length===0?e.jsx("div",{className:"rc-empty",children:"…"}):e.jsx("ul",{children:O.map(t=>e.jsxs("li",{children:[e.jsxs("span",{className:"rc-ts",children:["[",ue(t.ts),"]"]}),e.jsx("span",{className:se(t.author),children:t.author}),e.jsx("span",{children:": "}),e.jsx("span",{children:t.text}),y&&e.jsxs("span",{className:"rc-actions",children:[e.jsx("button",{className:"rc-ax",onClick:()=>te(t.id,t.text),children:"Ред."}),e.jsx("button",{className:"rc-ax",onClick:()=>ee(t.id),children:"Удал."})]})]},t.id))}):e.jsx("div",{className:"rc-empty",children:"Загрузка…"})}),e.jsxs("form",{className:"rc-form",onSubmit:t=>{t.preventDefault(),X()},children:[e.jsx("input",{className:"rc-input",placeholder:"напишите сообщение…",value:D,onChange:t=>H(t.target.value),maxLength:W,disabled:!o||!E||!d||p}),e.jsx("button",{type:"submit",className:"rc-btn",disabled:!o||!E||!d||p,children:"▶"})]})]}),o&&p&&e.jsx("div",{className:"nick-back",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"nick-card",children:[e.jsx("div",{style:{fontWeight:700,fontSize:16},children:"Выберите ник"}),e.jsx("div",{className:"nick-warn",children:"Ник задаётся один раз. Сменить его потом нельзя."}),e.jsxs("div",{className:"nick-row",children:[e.jsx("input",{className:"nick-input",value:P,onChange:t=>m(t.target.value),maxLength:80,placeholder:"Ваш ник…",autoFocus:!0}),e.jsx("button",{type:"button",className:"nick-btn",onClick:()=>m(k()),children:"🎲"}),e.jsx("button",{type:"button",className:"nick-btn",onClick:Z,children:"Ок"})]}),e.jsx("div",{children:Array.from({length:5}).map((t,r)=>e.jsx("span",{className:"nick-pill",onClick:()=>m(k()),children:"🎲 Случайный"},r))})]})})]})}const je=[{icon:e.jsx(pe,{className:"h-5 w-5 text-sky-300"}),title:"Открытый доступ",text:"Все материалы идут через защищённый HTTPS. Админский вход — только по секрету."},{icon:e.jsx(me,{className:"h-5 w-5 text-emerald-300"}),title:"Живой брифинг",text:"Чат для команды без регистрации: случайные ники, быстрый вход и модерация."},{icon:e.jsx(q,{className:"h-5 w-5 text-indigo-300"}),title:"Всегда в курсе",text:"Лента уведомлений синхронизируется с Telegram и хранит последние 100 событий."},{icon:e.jsx(G,{className:"h-5 w-5 text-rose-300"}),title:"Инструменты админа",text:"Правки и удаление сообщений доступны напрямую из интерфейса."}],we=[{to:"/faq",label:"FAQ",icon:e.jsx(ie,{className:"h-4 w-4"}),hint:"короткие ответы на частые вопросы"},{to:"/rules",label:"Правила",icon:e.jsx(le,{className:"h-4 w-4"}),hint:"единый набор ограничений и допусков"},{to:"/news",label:"Новости",icon:e.jsx(oe,{className:"h-4 w-4"}),hint:"хронология изменений и апдейтов"}],ke=[{icon:e.jsx(V,{className:"h-4 w-4 text-sky-300"}),title:"Навигация в один клик",text:"Структура ролей, законов и гайдов собрана в единое дерево."},{icon:e.jsx(de,{className:"h-4 w-4 text-amber-300"}),title:"Быстрые действия",text:"Командная палитра и избранное ускоряют переход к нужным материалам."},{icon:e.jsx(xe,{className:"h-4 w-4 text-emerald-300"}),title:"Чистая база знаний",text:"Обновления версий и диффы фиксируются прямо на портале."}],ye=[{title:"Старт дня",text:"Откройте «Новости», чтобы увидеть последние апдейты из Telegram и KV."},{title:"Рабочий процесс",text:"Используйте поиск и избранное, чтобы быстро прыгать по ролям и законам."},{title:"Синхронизация",text:"Отмечайте важное в чате — команда сразу увидит подсветку и сможет отреагировать."}];function Ee(){const i=n.useRef(null);return n.useEffect(()=>{document.title="Правительство — Памятка (SKY)"},[]),e.jsxs("main",{className:"relative min-h-screen overflow-hidden bg-slate-950 text-slate-100",children:[e.jsxs("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 -z-10",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(900px_400px_at_20%_10%,rgba(56,189,248,0.18),transparent_70%),radial-gradient(800px_500px_at_80%_0%,rgba(236,72,153,0.16),transparent_70%),linear-gradient(180deg,rgba(15,23,42,0.9),rgba(2,6,23,0.92))]"}),e.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(120deg,rgba(255,255,255,0.05)_1px,transparent_1px)] [background-size:42px_42px] opacity-[0.08]"})]}),e.jsx("section",{ref:i,className:"relative mx-auto max-w-6xl px-4 pb-12 pt-12 sm:pt-16",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1.1fr_minmax(240px,0.9fr)]",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-8 shadow-[0_30px_70px_rgba(14,23,42,0.55)] backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs font-semibold uppercase tracking-[0.25em] text-sky-200/80",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"SKY PORTAL"})]}),e.jsx("h1",{className:"mt-6 text-3xl font-semibold leading-tight text-slate-50 sm:text-4xl",children:"Главная точка входа в рабочую экосистему SKY"}),e.jsx("p",{className:"mt-4 max-w-2xl text-base text-slate-300/90 sm:text-lg",children:"Быстрые ссылки, база знаний и живой чат в едином пространстве. Всё синхронизировано и доступно из любого устройства."}),e.jsx("div",{className:"mt-8 grid gap-3 sm:grid-cols-3",children:we.map(s=>e.jsxs(re,{to:s.to,className:"group relative flex flex-col gap-2 rounded-2xl border border-white/10 bg-gradient-to-br from-white/10 via-white/5 to-white/0 p-4 text-sm transition hover:border-sky-300/60 hover:from-white/20",children:[e.jsxs("span",{className:"flex items-center gap-2 font-semibold text-slate-100",children:[s.icon,s.label,e.jsx(ne,{className:"h-3.5 w-3.5 text-sky-200 opacity-0 transition group-hover:translate-x-1 group-hover:opacity-100"})]}),e.jsx("span",{className:"text-xs text-slate-300/80",children:s.hint})]},s.to))})]}),e.jsxs("div",{className:"relative flex flex-col gap-4 rounded-3xl border border-white/10 bg-white/5 p-6 backdrop-blur",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.4em] text-slate-400",children:"Сводка"}),e.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-50",children:"Рабочий режим"})]}),e.jsx(ce,{className:"h-5 w-5 text-slate-300/70"})]}),e.jsx("ul",{className:"space-y-4 text-sm text-slate-300/90",children:ke.map(s=>e.jsxs("li",{className:"flex gap-3 rounded-2xl border border-white/10 bg-white/10 p-3",children:[e.jsx("span",{className:"mt-0.5 inline-flex h-8 w-8 items-center justify-center rounded-xl bg-black/40 shadow-inner",children:s.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-100",children:s.title}),e.jsx("p",{className:"text-xs text-slate-300/80",children:s.text})]})]},s.title))})]})]})}),e.jsx("section",{className:"relative mx-auto max-w-6xl px-4 pb-12",children:e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:je.map(s=>e.jsxs("div",{className:"group relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-5 shadow-[0_20px_50px_rgba(15,23,42,0.35)] transition hover:border-sky-300/50 hover:shadow-[0_25px_60px_rgba(37,99,235,0.35)]",children:[e.jsxs("div",{className:"mb-4 inline-flex items-center gap-3 rounded-2xl bg-black/30 px-3 py-2 text-sm font-semibold text-slate-100",children:[s.icon,s.title]}),e.jsx("p",{className:"text-sm text-slate-300/90",children:s.text})]},s.title))})}),e.jsx("section",{className:"relative mx-auto max-w-6xl px-4 pb-12",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1.2fr_minmax(260px,1fr)]",children:[e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-6 shadow-[0_20px_45px_rgba(8,47,73,0.35)] backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold uppercase tracking-[0.3em] text-sky-200/70",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{children:"Рабочий ритм"})]}),e.jsx("h2",{className:"mt-4 text-2xl font-semibold text-slate-50 sm:text-3xl",children:"Как использовать портал максимально эффективно"}),e.jsx("ol",{className:"mt-6 space-y-5 text-sm text-slate-300/90",children:ye.map((s,N)=>e.jsxs("li",{className:"relative rounded-2xl border border-white/10 bg-black/30 p-4",children:[e.jsx("span",{className:"absolute -left-3 -top-3 flex h-9 w-9 items-center justify-center rounded-2xl border border-sky-300/60 bg-sky-500/20 text-base font-semibold text-sky-100 shadow-[0_10px_25px_rgba(14,165,233,0.35)]",children:N+1}),e.jsxs("div",{className:"pl-6",children:[e.jsx("div",{className:"font-semibold text-slate-100",children:s.title}),e.jsx("p",{className:"mt-1 text-xs text-slate-300/80",children:s.text})]})]},s.title))})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-sky-500/15 via-transparent to-emerald-500/20 p-6 text-sm text-slate-200 shadow-[0_20px_45px_rgba(30,64,175,0.45)]",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.4em] text-slate-200/80",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"Совет"})]}),e.jsx("p",{className:"mt-4 text-sm text-slate-100",children:"Закрепляйте ключевые материалы в избранном и используйте командную палитру (⌘K) — так вы экономите время на поиск."})]}),e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-6 text-sm text-slate-200 shadow-[0_18px_40px_rgba(14,23,42,0.45)]",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.35em] text-slate-400",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{children:"Регламент"})]}),e.jsx("p",{className:"mt-3 text-sm text-slate-300/90",children:"Протоколы и роли всегда доступны в актуальных версиях. Смотрите вкладку «Новости», чтобы отслеживать свежие обновления и изменения политик."})]})]})]})}),e.jsx("section",{className:"relative mx-auto max-w-6xl px-4 pb-16",children:e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-6 shadow-[0_24px_60px_rgba(12,74,110,0.4)]",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3 text-sm font-semibold uppercase tracking-[0.3em] text-sky-200/70",children:[e.jsx(G,{className:"h-5 w-5"}),e.jsx("span",{children:"Команда онлайн"})]}),e.jsx(Ne,{room:"global",className:"bg-transparent"})]})})]})}export{Ee as default};
