import{j as e,L as J}from"./index-D-uHAjGO.js";import{R as d}from"./react-vendor-DTkXckhQ.js";import{t as P,s as w,U as E,V as $,W as A,Y as B,c as W,Z as T}from"./icons-J8W3zK9a.js";const N=800,C="chat:nick",V=d.useRef({}),I=["Скай-Страж","Право-Самурай","Пульс-Рейдер","Кибер-Медик","Неон-Тактик","Астрал-Офицер","Фантом-Лечащий","Шифр-Инспектор","Квант-Боец","Пиксель-Волк","Туман-Командор","Искра-Наблюдатель","Нуль-Гравитация","Полярный Пилот","Городской Хирург","Сыворотка-Vibe","Стерильный Ниндзя","Скальпель-Облако","Рентген-Панк","Ватка-Supreme"];function O(){const t=I[Math.floor(Math.random()*I.length)],u=Math.floor(Math.random()*900+100);return`${t} #${u}`}function Y(t){try{return typeof t=="string"?JSON.parse(t):t instanceof ArrayBuffer?JSON.parse(new TextDecoder().decode(t)):(typeof Blob<"u"&&t instanceof Blob,null)}catch{return null}}function K({room:t="global",className:u}){const f="wss://notifications-worker.wizardiowhy.workers.dev/chat",[p,v]=d.useState(!1),[x,y]=d.useState(!1),[k,S]=d.useState(""),[g,m]=d.useState([]),h=d.useRef(null),_=d.useRef(null),[b]=d.useState(()=>{try{const s=localStorage.getItem(C);if(s)return s;const r=O();return localStorage.setItem(C,r),r}catch{return O()}});d.useEffect(()=>{const s=_.current;s&&(s.scrollTop=s.scrollHeight)},[g.length]),d.useEffect(()=>{let s=!1,r=0;const n=()=>{if(s)return;const i=new URL(f);i.searchParams.set("room",t);const l=new WebSocket(i);h.current=l,l.addEventListener("open",()=>{v(!0),r=0,l.send(JSON.stringify({type:"hello",name:b}))}),l.addEventListener("message",async j=>{try{let a=Y(j.data);if(!a&&typeof Blob<"u"&&j.data instanceof Blob){const c=await j.data.text();a=JSON.parse(c)}if(!a)return;a.type==="history"?m(a.messages):a.type==="message"?m(c=>c.some(o=>o.id===a.message.id)?c:[...c,a.message]):a.type==="delete"?m(c=>c.filter(o=>o.id!==a.id)):a.type==="edit"?m(c=>c.map(o=>o.id===a.id?{...o,text:a.text}:o)):a.type==="system"&&(a.text==="admin-ok"&&y(!0),a.text==="hello-ok"&&y(!1))}catch{}});const D=()=>{v(!1),!s&&(r=Math.min(r+1,6),setTimeout(n,400*r))};l.addEventListener("close",D),l.addEventListener("error",()=>l.close())};return n(),()=>{var i;s=!0;try{(i=h.current)==null||i.close()}catch{}}},[f,t,b]);function R(){const s=k.replace(/\s+/g," ").trim(),r=h.current;if(!s||!r||r.readyState!==WebSocket.OPEN)return;const n=`${Date.now()}_${Math.random().toString(36).slice(2)}`,i=`loc_${n}`;V.current[n]=i,m(l=>[...l,{id:i,author:x?"Admin":b,text:s,ts:Date.now()}]),r.send(JSON.stringify({type:"message",text:s.slice(0,N),cid:n})),S("")}function L(s){const r=h.current;!x||!r||r.readyState!==WebSocket.OPEN||r.send(JSON.stringify({type:"delete",id:s}))}function M(s,r){var l;const n=h.current;if(!x||!n||n.readyState!==WebSocket.OPEN)return;const i=(l=prompt("Изменить сообщение:",r))==null?void 0:l.trim();i&&n.send(JSON.stringify({type:"edit",id:s,text:i.slice(0,N)}))}return e.jsxs("div",{className:`rounded-2xl border border-[color:var(--card-border,rgba(255,255,255,0.12))] bg-[color:var(--surface,rgba(255,255,255,0.06))] p-3 text-sm backdrop-blur ${u??""}`,children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Общий чат"}),e.jsx("span",{className:`ml-2 inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[11px] ${p?"bg-emerald-500/15 text-emerald-200 border border-emerald-400/30":"bg-rose-500/15 text-rose-200 border border-rose-400/30"}`,children:p?"online":"offline"}),x&&e.jsx("span",{className:"ml-2 rounded-full border border-sky-400/40 bg-sky-500/20 px-2 py-0.5 text-[11px] text-sky-100",children:"Admin"})]}),e.jsxs("div",{className:"text-xs opacity-75",children:["Ваш ник: ",e.jsx("b",{children:b})]})]}),!f,e.jsxs("div",{ref:_,className:"max-h-80 overflow-auto rounded-lg border border-[color:var(--card-border,rgba(255,255,255,0.12))] bg-white/5 p-2 dark:bg-black/20",children:[g.length===0&&e.jsx("div",{className:"opacity-70",children:"Пока сообщений нет. Напишите первым!"}),e.jsx("ul",{className:"space-y-1",children:g.map(s=>e.jsxs("li",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs opacity-70",children:[new Date(s.ts).toLocaleString()," · ",e.jsx("b",{children:s.author})]}),e.jsx("div",{children:s.text})]}),x&&e.jsxs("div",{className:"shrink-0 space-x-1",children:[e.jsx("button",{className:"btn !px-2 !py-0.5",onClick:()=>M(s.id,s.text),children:"Ред."}),e.jsx("button",{className:"btn !px-2 !py-0.5",onClick:()=>L(s.id),children:"Удал."})]})]},s.id))})]}),e.jsxs("form",{className:"mt-2 flex items-center gap-2",onSubmit:s=>{s.preventDefault(),R()},children:[e.jsx("input",{className:"flex-1 rounded-md border border-[color:var(--card-border,rgba(255,255,255,0.12))] bg-transparent px-2 py-1",placeholder:"Напишите сообщение…",value:k,onChange:s=>S(s.target.value),maxLength:N,disabled:!p}),e.jsx("button",{type:"submit",className:"btn btn-primary disabled:opacity-50",disabled:!p,children:"Отправить"})]})]})}function q(){return e.jsxs("main",{className:"relative min-h-dvh w-full overflow-x-hidden text-white",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-slate-950 to-slate-900"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(900px_600px_at_15%_10%,rgba(56,189,248,0.25),transparent_70%),radial-gradient(800px_500px_at_85%_20%,rgba(129,140,248,0.25),transparent_70%),radial-gradient(700px_600px_at_50%_100%,rgba(244,63,94,0.14),transparent_70%)]"})]}),e.jsx("header",{className:"sticky top-0 z-20 mx-auto w-full max-w-6xl px-4 pt-6 sm:px-6 lg:px-8",children:e.jsx("div",{className:"rounded-2xl border border-[color:var(--card-border,rgba(255,255,255,0.12))] bg-[color:var(--surface,rgba(255,255,255,0.08))] px-4 py-3 backdrop-blur-md",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-xl bg-gradient-to-br from-sky-500/80 to-indigo-500/80 shadow-lg shadow-sky-500/20",children:e.jsx(P,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm uppercase tracking-[0.22em] text-white/70",children:"SKY • PRAVO"}),e.jsx("div",{className:"-mt-0.5 text-lg font-semibold",children:"Центр управления"})]})]}),e.jsxs("nav",{className:"hidden items-center gap-2 sm:flex",children:[e.jsx("a",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-white/80 hover:bg-white/10",href:"#news",children:"Новости"}),e.jsx("a",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-white/80 hover:bg-white/10",href:"#chat",children:"Чат"}),e.jsx("a",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-white/80 hover:bg-white/10",href:"#links",children:"Ссылки"})]})]})})}),e.jsx("section",{className:"mx-auto mt-8 w-full max-w-6xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-white/10 bg-white/10 p-8 shadow-[0_40px_120px_-60px_rgba(56,189,248,0.45)] backdrop-blur",children:[e.jsx("div",{className:"absolute -right-16 -top-16 h-56 w-56 rounded-full bg-gradient-to-br from-sky-500 to-indigo-500 opacity-40 blur-3xl","aria-hidden":!0}),e.jsx("div",{className:"absolute -bottom-20 -left-10 h-64 w-64 rounded-full bg-gradient-to-br from-fuchsia-500 to-rose-500 opacity-30 blur-3xl","aria-hidden":!0}),e.jsx(J,{}),e.jsxs("div",{className:"relative grid gap-8 lg:grid-cols-2 lg:items-center",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("h1",{className:"text-4xl font-bold leading-tight sm:text-5xl sm:leading-[1.1]",children:["Главная панель ",e.jsx("span",{className:"text-sky-300",children:"сообщества"})]}),e.jsx("p",{className:"max-w-2xl text-white/80 sm:text-lg",children:"Новости, цели и чат команды — в одном месте. Неоновый ночной стиль + жидкое стекло под твой сайт."}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("a",{href:"#chat",className:"group inline-flex items-center gap-2 rounded-2xl border border-sky-400/40 bg-sky-500/20 px-4 py-2 text-sky-100 hover:bg-sky-500/30",children:["Открыть чат",e.jsx(w,{className:"h-4 w-4 transition-transform group-hover:translate-x-0.5"})]}),e.jsx("a",{href:"#links",className:"inline-flex items-center gap-2 rounded-2xl border border-white/10 bg-white/5 px-4 py-2 text-white/80 hover:bg-white/10",children:"Полезные ссылки"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-white/70",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1.5",children:[e.jsx(E,{className:"h-4 w-4"})," Команда"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1.5",children:[e.jsx($,{className:"h-4 w-4"})," Поддержка"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1.5",children:[e.jsx(A,{className:"h-4 w-4"})," События"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{label:"Участники",value:"142",Icon:E},{label:"Повышений за нед.",value:"18",Icon:B},{label:"Активные задачи",value:"7",Icon:W},{label:"События на неделе",value:"5",Icon:A}].map(t=>e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-slate-950/60 p-5 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center justify-between text-white/70",children:[e.jsx("span",{className:"text-sm",children:t.label}),e.jsx(t.Icon,{className:"h-4 w-4"})]}),e.jsx("div",{className:"mt-2 text-2xl font-semibold",children:t.value})]},t.label))})]})]})}),e.jsx("section",{id:"news",className:"mx-auto mt-10 w-full max-w-6xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-5",children:[e.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/10 p-6 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Новости"}),e.jsx(T,{className:"h-5 w-5 text-white/60"})]}),e.jsxs("ul",{className:"mt-4 space-y-3 text-sm text-white/85",children:[e.jsxs("li",{className:"rounded-2xl border border-emerald-400/30 bg-emerald-500/10 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-white/70",children:["Сегодня • 18:00 ",e.jsx("span",{className:"rounded-full border border-emerald-400/50 bg-emerald-400/20 px-2 py-0.5 text-emerald-100",children:"Обновление"})]}),e.jsx("p",{className:"mt-1",children:"Обновлён регламент по повышению медперсонала. Проверь раздел «Документы»."})]}),e.jsxs("li",{className:"rounded-2xl border border-sky-400/30 bg-sky-500/10 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-white/70",children:["Вчера • 22:15 ",e.jsx("span",{className:"rounded-full border border-sky-400/50 bg-sky-400/20 px-2 py-0.5 text-sky-100",children:"Событие"})]}),e.jsx("p",{className:"mt-1",children:"Совместный рейд завершён успешно. Отдельное спасибо кураторам."})]}),e.jsxs("li",{className:"rounded-2xl border border-amber-400/30 bg-amber-500/10 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-white/70",children:["На этой неделе ",e.jsx("span",{className:"rounded-full border border-amber-400/50 bg-amber-400/20 px-2 py-0.5 text-amber-100",children:"Важно"})]}),e.jsx("p",{className:"mt-1",children:"Собрать отчёты по отделам до пятницы 20:00."})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-6 backdrop-blur",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Ближайшие дела"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-white/80",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-400"})," Проверить заявки на повышение (до 12:00 завтра)"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-sky-400"})," Подготовить план мероприятия на выходные"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-rose-400"})," Отправить сводку по отделам"]})]})]})]}),e.jsxs("div",{id:"chat",className:"lg:col-span-3",children:[e.jsxs("div",{className:"flex items-center justify-between pb-3",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Командный чат"}),e.jsx("span",{className:"text-sm text-white/60",children:"Онлайн: ~"})]}),e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-white/10 bg-slate-950/60 p-4 shadow-2xl backdrop-blur",children:[e.jsx(K,{room:"global",allowAdminEdit:!0,className:"bg-transparent border-0 p-0"}),e.jsxs("p",{className:"mt-2 text-xs text-white/60",children:["Чтобы писать как ",e.jsx("b",{children:"Admin"}),", владелец вводит секретный ключ ",e.jsx("code",{children:"VITE_CHAT_ADMIN_CODE"})," через кнопку «🔑 Admin»."]})]})]})]})}),e.jsxs("section",{id:"links",className:"mx-auto mt-10 w-full max-w-6xl px-4 pb-16 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/10 p-6 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Быстрые ссылки"}),e.jsx(w,{className:"h-5 w-5 text-white/60"})]}),e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[{title:"Документы",desc:"Регламенты, уставы, шаблоны",href:"/pravo/docs"},{title:"Повышения",desc:"Критерии и заявки",href:"/pravo/promotions"},{title:"Состав",desc:"Роли, отделы, контакты",href:"/pravo/teams"},{title:"Отчёты",desc:"Еженедельные сводки",href:"/pravo/reports"}].map(t=>e.jsx("a",{href:t.href,className:"group rounded-2xl border border-white/10 bg-slate-950/60 p-4 backdrop-blur transition hover:border-white/20 hover:bg-slate-900/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium",children:t.title}),e.jsx("div",{className:"text-xs text-white/70",children:t.desc})]}),e.jsx(w,{className:"h-4 w-4 translate-x-0 transition-transform group-hover:translate-x-1"})]})},t.title))})]}),e.jsxs("footer",{className:"mt-8 flex items-center justify-between text-xs text-white/60",children:[e.jsxs("div",{children:["© ",new Date().getFullYear()," SKY • PRAVO"]}),e.jsx("a",{href:"#top",className:"rounded-lg border border-white/10 bg-white/5 px-2 py-1 hover:bg-white/10",children:"Наверх"})]})]})]})}export{q as default};
